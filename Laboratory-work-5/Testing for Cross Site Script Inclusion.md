## Тестування на Включення Міжсайтового Сценарію
| ID |
|:-:|
| WSTG-CLNT-13 |

### Короткий опис
Уразливість Включення Міжсайтового Сценарію (XSSI) дозволяє витік чутливих даних через межі джерел або доменів, які відрізняються одне від одного. Серед чутливих даних можуть бути дані, пов'язані з автентифікацією (стан автентифікації, файли cookie, маркери автентифікації, ідентифікатори сесій тощо) або особисті або чутливі особисті дані користувача (адреси електронної пошти, номери телефонів, дані кредитних карток, номери соціального страхування тощо). XSSI - це атака на клієнтському боці, подібна до атаки Підробки Міжсайтового Запиту (CSRF), але має інший метафункціональний характер. Де CSRF використовує контекст автентифікованого користувача для виконання певних дій, які змінюють стан на сторінці жертви (наприклад, переказ грошей на рахунок атакуючого, зміна привілеїв, скидання пароля тощо), XSSI натомість використовує JavaScript на клієнтському боці для витоку чутливих даних із автентифікованих сесій.

За замовчуванням веб-сайти мають доступ до даних лише у випадку, якщо вони належать до того самого джерела. Це є ключовим принципом безпеки застосунків і регулюється політикою однакового походження (визначено [RFC 6454](https://datatracker.ietf.org/doc/html/rfc6454)). Походження визначається як поєднання схеми URI (HTTP або HTTPS), імені хоста та номера порту. Однак ця політика не застосовується до включень тегу HTML `<script>`. Ця виняткова ситуація необхідна, оскільки без неї веб-сайти не змогли б використовувати послуги сторонніх постачальників, проводити аналіз трафіку або використовувати рекламні платформи тощо.

Коли браузер відкриває веб-сайт із тегами `<script>`, ресурси отримуються з домену, що відрізняється за походженням. Ресурси потім запускаються в тому самому контексті, що і включений веб-сайт або браузер, що створює можливість витоку чутливих даних. У більшості випадків цього досягається за допомогою JavaScript, але джерело скрипта не обов'язково має бути файлом JavaScript із типом `text/javascript` або розширенням `.js`.

Вразливості старих браузерів (IE9/10) дозволяли витік даних через повідомлення про помилки JavaScript під час виконання, але ці вразливості вже були усунуті постачальниками і вважаються менш актуальними. Встановивши атрибут charset тегу `<script>`, атакуючий або тестер може задати кодування UTF-16, що дозволяє витік даних в інших форматах (наприклад, JSON) у деяких випадках. Для отримання більше інформації щодо таких атак, дивіться атаки, [засновані на ідентифікаторах XSSI](https://www.mbsd.jp/Whitepaper/xssi.pdf).
